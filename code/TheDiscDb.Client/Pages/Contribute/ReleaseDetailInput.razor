@page "/contribute/{mediaType}/{externalId}"

@rendermode @(new InteractiveAutoRenderMode(prerender:false))

@if (this.externalData != null)
{
    <TheDiscDb.Client.Controls.Breadcrumb PrimaryText="@BreadcrumbText" Items="[
        GetRootContributionLink()
    ]" />
}

<h3>Create Release</h3>

<EditForm Model="@request" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label>Release Date<span class="required">*</span></label>
        <InputText class="form-control" @bind-Value="releaseDate" @oninput="ReleaseDateChanged" />
        <div class="validation-message">@releaseDateValidationMessage</div>
    </div>
    <div class="mb-3">
        <label>ASIN<span class="required">*</span></label>
        <InputText class="form-control" @bind-Value="request.Asin" />
        <ValidationMessage For="@(() => request.Asin)" />
    </div>
    <div class="mb-3">
        <label>UPC<span class="required">*</span></label>
        <InputText class="form-control" @bind-Value="request.Upc" />
        <ValidationMessage For="@(() => request.Upc)" />
    </div>
    <div class="mb-3">
        <label>Front Image<span class="required">*</span></label>
        <SfUploader AutoUpload="true" ShowFileList="true" AllowMultiple="false" AllowedExtensions=".jpg, .jpeg">
            <UploaderButtons Browse="Browse"></UploaderButtons>
            <UploaderEvents FileSelected="FrontImageSelected" OnRemove="FrontImageRemoved"></UploaderEvents>
            <UploaderAsyncSettings SaveUrl="@frontImageUploadUrl" RemoveUrl="@frontImageRemoveUrl"></UploaderAsyncSettings>
        </SfUploader>
        <ValidationMessage For="@(() => request.FrontImageUrl)" />
    </div>
    <div class="mb-3">
        <label>Back Image</label>
        <SfUploader AutoUpload="true" ShowFileList="true" AllowMultiple="false" AllowedExtensions=".jpg, .jpeg">
            <UploaderButtons Browse="Browse"></UploaderButtons>
            <UploaderEvents FileSelected="BackImageSelected" OnRemove="BackImageRemoved"></UploaderEvents>
            <UploaderAsyncSettings SaveUrl="@backImageUploadUrl" RemoveUrl="@backImageRemoveUrl"></UploaderAsyncSettings>
        </SfUploader>
        <ValidationMessage For="@(() => request.BackImageUrl)" />
    </div>
    <div class="mb-3">
        <label>Release Title<span class="required">*</span></label>
        <InputText class="form-control" @bind-Value="request.ReleaseTitle" @oninput="ReleaseTitleChanged" />
        <ValidationMessage For="@(() => request.ReleaseTitle)" />
    </div>
    <div class="mb-3">
        <label>Release Slug<span class="required">*</span></label>
        <InputText class="form-control" @bind-Value="request.ReleaseSlug" />
        <ValidationMessage For="@(() => request.ReleaseSlug)" />
    </div>
    <div class="mb-3">
        <label>Locale</label>
        <InputText class="form-control" @bind-Value="request.Locale" />
        <ValidationMessage For="@(() => request.Locale)" />
    </div>
    <div class="mb-3">
        <label>Region Code</label>
        <InputText class="form-control" @bind-Value="request.RegionCode" />
        <ValidationMessage For="@(() => request.RegionCode)" />
    </div>
    <a class="btn btn-secondary" href="/contribute/@this.MediaType">Back</a>
    <button type="submit" class="btn btn-primary">Submit</button>
</EditForm>